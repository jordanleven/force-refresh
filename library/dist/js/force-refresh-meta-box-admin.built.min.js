!function(a,b,c){var d={class_name:"ForceReloadMetaBoxAdmin",default_options:{api_url:ajaxurl,elements:{force_refresh_meta_box:"#force_refresh_specific_page_refresh",meta_box_refresh_type:"#force-refresh-meta-box-refresh-type-selector",meta_box_refresh_options_container:"#force-refresh-meta-box-refresh-type-options-container",meta_box_refresh_button:"#force-refresh-admin-page"}},init:function(){var b=this;this.options=this.default_options,a(this.options.elements.meta_box_refresh_button).click(function(a){a.preventDefault(),b.ajaxCall(b.options.api_url,"POST",{success:b.adminBarRefreshPageCallbackSuccess,fail:b.adminBarRefreshPageCallbackFailure},{action:"force_refresh_update_page_version",page_id:force_refresh_local_js.post_id,nonce:force_refresh_local_js.nonce})})},adminBarRefreshPageCallbackSuccess:function(a){var b=this;setTimeout(function(){b.addAdminNotice("You've successfully refreshed this page. All connected browsers will refresh within "+force_refresh_local_js.refresh_interval+" seconds.")},1500)},addAdminNotice:function(b,d){d=d||"success";var e=c.getElementById(force_refresh_local_js.handlebars_admin_notice_template_id).innerHTML,f=Handlebars.compile(e),g={message:b},h=f(g);a("#force_refresh_specific_page_refresh").before(h).next()},adminBarRefreshPageCallbackFailure:function(){},bindMetaBoxRefreshTypeUpdates:function(b){var c=this,d=a(b).val();a(this.options.elements.meta_box_refresh_options_container).children("div[data-refresh-type='"+d+"']").addClass("selected"),a("#force-refresh-meta-box-refresh-type-descriptions").children("li[data-refresh-type='"+d+"']").addClass("selected"),a(b).change(function(b){var d=a(this).val();a(c.options.elements.meta_box_refresh_options_container).children("div").removeClass("selected").end().children("div[data-refresh-type='"+d+"']").addClass("selected"),a("#force-refresh-meta-box-refresh-type-descriptions").children("li").removeClass("selected").end().children("li[data-refresh-type='"+d+"']").addClass("selected")})},refreshSiteCallbackSuccess:function(a){var b=this;this.spinLogo(),setTimeout(function(){a.ajax_data;b.addNotice(a.ajax_data.status_text)},1e3)},refreshSiteCallbackFailure:function(a){a.ajax_data;this.addNotice(a.ajax_data.status_text,"error")},addNotice:function(b,c){c=c||"success";var d='<div class="notice notice-invisible notice-hidden notice-'+c+' is-dismissible"><p><strong>'+b+"</strong></p></div>";a("body").append(d).find(".notice").removeClass("notice-invisible").addClass("notice-force-refresh-tmp");var e=a("body").find(".notice-force-refresh-tmp").outerHeight();a("body").find(".notice-force-refresh-tmp").remove(),a(this.options.elements.force_refresh_admin_notice_container).empty().html(d).find(".notice").css("height",0).removeClass("notice-hidden").animate({height:e+"px"},500,function(){a(this).removeClass("notice-invisible").css("height","auto")})},spinLogo:function(){a(".site-refresh-inner .logo").addClass("logo-spin"),setTimeout(function(){a(".site-refresh-inner .logo.logo-spin").removeClass("logo-spin")},1e3)},ajaxCall:function(b,c,d,e,f){e=e||{},f=f||{},f.data_object=e,this.debug("Submitting AJAX call..."),a.ajax({type:c,url:b,context:this,data:e,dataType:"JSON"}).done(function(a){this.debug("AJAX call finished.")}).success(function(a){a.success?d.success&&d.success.call(this,{ajax_data:a,additional_arguments:f}):this.error(a)}).always(function(){d.always&&d.always.call(this)}).fail(function(a){this.error("AJAX error. Error below:"),this.error(a),d.fail&&d.fail.call(this,{ajax_data:a.responseJSON,additional_arguments:f})})},debug:function(a){a="string"==typeof a?a:JSON.stringify(a)},error:function(a){a="string"==typeof a?a:JSON.stringify(a),console.error(this.class_name+" - "+a)},warn:function(a){a="string"==typeof a?a:JSON.stringify(a),console.warn(this.class_name+" - "+a)}};a(function(){try{Object.create(d).init()}catch(a){console.error("Error creating object ("+d.class_name+")! See error below for details."),console.error(a)}})}(jQuery,window,document);
!function(a,b,c){var d={class_name:"ForceReloadAdmin",default_options:{api_url:ajaxurl,elements:{force_refresh_admin_wp_admin_bar:"#wp-admin-bar-force-refresh",force_refresh_admin_wp_admin_bar_spin_logo:"#wp-admin-bar-force-refresh .fa-refresh",force_refresh_admin_form:"#force-refresh-admin",force_refresh_admin_notice_container:"#alert-container"}},init:function(){this.options=this.default_options,this.bindRefreshWPAdminBar(this.options.elements.force_refresh_admin_wp_admin_bar),this.bindFormUpdates(this.options.elements.force_refresh_admin_form)},addAdminNotice:function(b,d){d=d||"success";var e=c.getElementById(force_refresh_local_js.handlebars_admin_notice_template_id).innerHTML,f=Handlebars.compile(e),g={message:b},h=f(g);a(".wrapn .wp-header-end").after(h).next().find(".notice-dismiss").click(function(){a(this).parents(".notice").remove()})},bindRefreshWPAdminBar:function(b){var c=this;a(b).click(function(){c.ajaxCall(c.options.api_url,"POST",{success:c.adminBarRefreshSiteCallbackSuccess,fail:c.adminBarRefreshSiteCallbackFailure},{action:"force_refresh_update_site_version",nonce:force_refresh_local_js.nonce})})},adminBarRefreshSiteCallbackSuccess:function(a){var b=this;this.spinLogo(this.options.elements.force_refresh_admin_wp_admin_bar_spin_logo),setTimeout(function(){b.addAdminNotice("You've successfully refreshed your site. All connected browsers will refresh within "+force_refresh_local_js.refresh_interval+" seconds.")},1500)},adminBarRefreshSiteCallbackFailure:function(){},bindFormUpdates:function(b){var c=this;a(b).submit(function(b){a(c.options.elements.force_refresh_admin_notice_container).empty(),b.preventDefault(),c.ajaxCall(c.options.api_url,"POST",{success:c.refreshSiteCallbackSuccess,fail:c.refreshSiteCallbackFailure},{action:"force_refresh_update_site_version",nonce:force_refresh_local_js.nonce})})},refreshSiteCallbackSuccess:function(a){var b=this;this.spinLogo(".site-refresh-inner .logo"),setTimeout(function(){a.ajax_data;b.addNotice(a.ajax_data.status_text)},1e3)},refreshSiteCallbackFailure:function(a){a.ajax_data;this.addNotice(a.ajax_data.status_text,"error")},addNotice:function(b,c){c=c||"success";var d='<div class="notice notice-invisible notice-hidden notice-'+c+' is-dismissible"><p><strong>'+b+"</strong></p></div>";a("body").append(d).find(".notice").removeClass("notice-invisible").addClass("notice-force-refresh-tmp");var e=a("body").find(".notice-force-refresh-tmp").outerHeight();a("body").find(".notice-force-refresh-tmp").remove(),a(this.options.elements.force_refresh_admin_notice_container).empty().html(d).find(".notice").css("height",0).removeClass("notice-hidden").animate({height:e+"px"},500,function(){a(this).removeClass("notice-invisible").css("height","auto")})},spinLogo:function(b){a(b).addClass("logo-spin"),setTimeout(function(){a(b+".logo-spin").removeClass("logo-spin")},1e3)},ajaxCall:function(b,c,d,e,f){a(".notice.notice-force-refresh").remove(),e=e||{},f=f||{},f.data_object=e,this.debug("Submitting AJAX call..."),a.ajax({type:c,url:b,context:this,data:e,dataType:"JSON"}).done(function(a){this.debug("AJAX call finished.")}).success(function(a){a.success?d.success&&d.success.call(this,{ajax_data:a,additional_arguments:f}):this.error(a)}).always(function(){d.always&&d.always.call(this)}).fail(function(a){this.error("AJAX error. Error below:"),this.error(a),d.fail&&d.fail.call(this,{ajax_data:a.responseJSON,additional_arguments:f})})},debug:function(a){a="string"==typeof a?a:JSON.stringify(a)},error:function(a){a="string"==typeof a?a:JSON.stringify(a),console.error(this.class_name+" - "+a)},warn:function(a){a="string"==typeof a?a:JSON.stringify(a),console.warn(this.class_name+" - "+a)}};a(function(){try{Object.create(d).init()}catch(a){console.error("Error creating object ("+d.class_name+")! See error below for details."),console.error(a)}})}(jQuery,window,document);